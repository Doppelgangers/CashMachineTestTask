# Тестовое задание для Python разработчика (Кассовый апарат на django4+drf)

Необходимо написать «кассовый аппарат» для вымышленного магазина.

При выполнении задания необходимо использовать **Python 3** и **Django**, **Django Rest Framework**

## Условия

#### Описание принципа работы «кассового аппарата»

### Этап 1

Предварительно нужно будет написать модель данных для товара `Item`. Модель должна содержать следующие поля.

| id | айди товара |
| --- | --- |
| title | наименование |
| price | стоимость |

На веб-узел `{{root}}/cash_machine` с помощью метода **POST** отправляется следующее тело запроса:
json
```
{
	"items": [1, 2, 3]
}
```
где `items` это массив id товаров модели `Item`.

При этом запросе сервер должен формировать чек в формате PDF. 
Пример чека: 

![Снимок экрана 2022-04-19 в 15.12.34.png](https://hail-dime-646.notion.site/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5bd878b5-0cd6-4039-93f0-12635b06df23%2F%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_2022-04-19_%D0%B2_15.12.34.png?table=block&id=19c049ef-1399-40e0-b9ca-501de5481b30&spaceId=c4067982-1af0-4f59-ba5a-991fa560b8c6&width=730&userId=&cache=v2)

В чек должны записываться следующие поля:

1. Для каждой позиции товара:

- Наименование
- Общее количество
- Общая стоимость
1. Итоговая сумма 
2. Время создания чека в формате (ДД.ММ.ГГГГ Ч:М)

HTML-шаблон чека приложен к заданию. Подставить вышеуказанные поля туда можно с помощью Jinja2. Для работы с PDF рекомендуется использовать библиотеку `pdfkit` https://pypi.org/project/pdfkit/ 

Сформированный PDF файл нужно просто сохранять в папку `media`Затем сервер формирует ссылку на этот PDF-файл и кодирует его в QR-код, а затем **высылает этот QR-код** **в качестве ответа на запрос.** Для работы с QR-кодами рекомендуется использовать библиотеку `qrcode`https://pypi.org/project/qrcode/ 

### Этап 2

При сканировании QR-код будет совершаться запрос **GET** `{{root}}/media/<наименование файла>` который в ответ будет возвращать этот файл.

Решение нужно будет загрузить на GitHub, либо Gitlab, либо Bitbucket как публичный репозиторий

## Требования

Установленный  `Python 3` и добаленный в PATH

## Установка
Скачайте репозиторий 

    git clone https://github.com/Doppelgangers/https://github.com/Doppelgangers/CashMachineTestTask


#### Автоматическая установка через  скрипт .bat
1. Запустите файл `insatll.bat`
2. Для запуска программы используйте `start.bat` 

#### Ручная установка 

1. Установите зависимости, указанные в файле requirements.txt, с помощью следующей команды:
    ```
    cmd
    pip install -r requirements.txt
    ```
2. Запустите скрипт main.py:
    ```
    cmd
    python main.py
    ```

## Пример работы

1) Отправляется POST запрос по адресу `http://{{domain}}/cash_machine` со споском id товаров 
    ```json
    {
        "items": [2,1,2,2]
    }
    ```
    В результате получаем qr код с ссылкой на товарный чек.
    

![postman.png](https://i.ibb.co/Chzjb8D/image.png)

2) При сканировании qr кода, откроется ссылка с файлом чека.pdf

![phonescreenssot.png](https://i.ibb.co/g6NtXvC/phone.png)

P.S: Важно, доменное имя в чеке будет таким же из которого совершался post запрос, поэтому если соверишь запрос по адресу 127.0.0.1 то ссылка на чек будет:
`http://127.0.0.1/media/{{ чек.pdf }}`

## Репозиторий

Вы можете найти код скрипта и файл requirements.txt в публичном репозитории на GitHub. [Ссылка на репозиторий](https://github.com/Doppelgangers/ParserShop)